E10 = case_when(
E10 == 1 ~ "Public",
E10 == 2 ~ "NGO",
E10 == 3 ~ "Private",
E10 == 4 ~ "Self-emplyed"
)
) %>%
mutate(
F6 = case_when(
F6 == 1 ~ "Public",
F6 == 2 ~ "NGO",
F6 == 3 ~ "Private",
F6 == 4 ~ "Self-employed"
)
)
primary_job_count <- decoded_data %>%
filter(!is.na(E10)) %>%
count(B3, name = "count")
primary_job_count
secondary_job_count <- decoded_data %>%
filter(!is.na(F6)) %>%
count(B3, name = "count")
secondary_job_count
plot_data <- decoded_data %>%
select(gender = B3, salary = E14_1, ownership = E10) %>%
filter(!is.na(salary), !is.na(ownership)) %>%
mutate(ownership = factor(ownership))
summary_stats <- plot_data %>%
group_by(gender, ownership) %>%
summarize(
mean_salary = mean(salary),
se = sd(salary) / sqrt(n()),
lower_ci = mean_salary - 1.96 * se,
upper_ci = mean_salary + 1.96 * se,
n = n(),
.groups = "drop"
) %>%
filter(n >= 10)
ggplot(summary_stats,
aes(x = ownership, y = mean_salary, fill = gender)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7) +
geom_errorbar(
aes(ymin = lower_ci, ymax = upper_ci),
position = position_dodge(width = 0.8),
width = 0.2,
color = "black"
) +
geom_text(
aes(label = paste0(round(mean_salary/1000, 1), "k \n(n=", n, ")"),
y = upper_ci),
position = position_dodge(width = 0.8),
vjust = -0.5,
size = 3
) +
labs(
title = "Mean Salary (AMD) by Company Ownership (Primary Job)",
subtitle = "Error bars show 95% confidence intervals",
x = "Ownership Type",
y = "Mean Salary (AMD)",
fill = "Gender"
) +
scale_y_continuous(labels = scales::comma) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
decoded_data <- cleaned_data %>%
mutate(
B3 = case_when(
B3 == 1 ~ "Male",
B3 == 2 ~ "Female",
TRUE ~ NA_character_
)
) %>%
mutate(
Age_16groups = case_when(
Age_16groups == 1 ~ "0-4",
Age_16groups == 2 ~ "5-9",
Age_16groups == 3 ~ "10-14",
Age_16groups == 4 ~ "15-19",
Age_16groups == 5 ~ "20-24",
Age_16groups == 6 ~ "25-29",
Age_16groups == 7 ~ "30-34",
Age_16groups == 8 ~ "35-39",
Age_16groups == 9 ~ "40-44",
Age_16groups == 10 ~ "45-49",
Age_16groups == 11 ~ "50-54",
Age_16groups == 12 ~ "55-59",
Age_16groups == 13 ~ "60-64",
Age_16groups == 14 ~ "65-69",
Age_16groups == 15 ~ "70-74",
Age_16groups == 16 ~ "75+",
TRUE ~ NA_character_
)
) %>%
mutate(
E15 = case_when(
E15 == 1 ~ "Up to 55 000 AMD",
E15 == 2 ~ "55 000 AMD",
E15 == 3 ~ "55 001 -  110 000 AMD",
E15 == 4 ~ "110 001 - 220 000 AMD",
E15 == 5 ~ "220 001 - 440 000 AMD",
E15 == 6 ~ "440 001 - 600 000 AMD",
E15 == 7 ~ "600 001 - 700 000 AMD",
E15 == 8 ~ "Refused to answer",
E15 == 9 ~ "Do not know / difficult to answer",
TRUE ~ NA_character_
)
) %>%
mutate(
A3 = case_when(
A3 == 1 ~ "Yerevan",
A3 == 2 ~ "Aragatsotn",
A3 == 3 ~ "Ararat",
A3 == 4 ~ "Armavir",
A3 == 5 ~ "Gegharkunik",
A3 == 6 ~ "Lori",
A3 == 7 ~ "Kotayq",
A3 == 8 ~ "Shirak",
A3 == 9 ~ "Syuniq",
A3 == 10 ~ "Vayoc Dzor",
A3 == 11 ~ "Tavush",
TRUE ~ NA_character_
)
)
mean_salary_by_region <- decoded_data %>%
select(gender = B3, region = A3, salary = E14_1) %>%
group_by(region, gender) %>%
summarise(mean_salary = mean(salary))
mean_salary_by_region
mean_salary_by_region <- decoded_data %>%
select(gender = B3, region = A3, salary = E14_1) %>%
group_by(region, gender) %>%
summarise(mean_salary = mean(salary, na.rm = TRUE))
mean_salary_by_region
library(readxl)
library(dplyr)
library(ggplot2)
library(knitr)
library(tidyr)
library(sf)
mean_salary_by_region <- decoded_data %>%
select(gender = B3, region = A3, salary = E14_1) %>%
filter(!is.na(region), !is.na(gender), !is.na(salary)) %>%
group_by(region, gender) %>%
summarise(mean_salary = mean(salary, na.rm = TRUE))
mean_salary_by_region
armenia_map <- st_read("https://github.com/glynnbird/countriesgeojson/blob/master/armenia.geojson")
library(readxl)
library(dplyr)
library(ggplot2)
library(knitr)
library(tidyr)
library(sf)
armenia_map <- st_read("https://github.com/glynnbird/countriesgeojson/blob/master/armenia.geojson")
armenia_map <- st_read("https://raw.githubusercontent.com/armstat/sdg-data-armenia/master/geo/marz.geojson")
armenia_map <- st_read("armenia.geojson")
armenia_map <- st_read("armenia.geojson")
map_data <- armenia_map %>%
left_join(mean_salary_by_region, by = c("name" = "region"))
ggplot(map_data) +
geom_sf(aes(fill = mean_salary), color = "white", size = 0.3) +
scale_fill_viridis_c(option = "plasma", na.value = "grey90") +
theme_minimal() +
labs(
title = "Mean Salary by Region (Armenia)",
fill = "Mean Salary"
)
armenia_map <- st_read("armenia.geojson")
map_data <- armenia_map %>%
left_join(mean_salary_by_region, by = c("name" = "region"))
ggplot(map_data) +
geom_sf(aes(fill = mean_salary), color = "white", size = 0.3) +
scale_fill_viridis_c(option = "plasma", na.value = "grey90") +
theme_minimal() +
labs(
title = "Mean Salary by Region (Armenia)",
fill = "Mean Salary"
)
map_data
armenia_map <- st_read("armenia.geojson")
map_data <- armenia_map %>%
left_join(mean_salary_by_region, by = c("name" = "region"))
ggplot(map_data) +
geom_sf(aes(fill = mean_salary), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey90") +
facet_wrap(~gender) +
theme_minimal() +
labs(
title = "Mean Salary by Region and Gender (Armenia)",
fill = "Mean Salary"
)
difference_in_mean_salary_by_region <- mean_salary_by_region %>%
pivot_wider(names_from = gender, values_from = mean_salary) %>%
mutate(difference = Male - Female)
difference_in_mean_salary_by_region <- mean_salary_by_region %>%
pivot_wider(names_from = gender, values_from = mean_salary) %>%
mutate(difference = Male - Female)
difference_in_mean_salary_by_region
difference_in_mean_salary_by_region <- mean_salary_by_region %>%
pivot_wider(names_from = gender, values_from = mean_salary) %>%
mutate(wage_gap = Male - Female) %>%
select(region, wage_gap)
difference_in_mean_salary_by_region
armenia_map <- st_read("armenia.geojson")
map_data <- armenia_map %>%
left_join(difference_in_mean_salary_by_region, by = c("name" = "region"))
ggplot(map_data) +
geom_sf(aes(fill = mean_salary), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey90") +
facet_wrap(~gender) +
theme_minimal() +
labs(
title = "Mean Salary by Region and Gender (Armenia)",
fill = "Mean Salary"
)
armenia_map <- st_read("armenia.geojson")
wage_gap_map <- armenia_map %>%
left_join(difference_in_mean_salary_by_region, by = c("NAME_1" = "region"))
armenia_map <- st_read("armenia.json")
wage_gap_map <- armenia_map %>%
left_join(difference_in_mean_salary_by_region, by = c("NAME_1" = "region"))
armenia_map <- st_read("armenia.json")
names(armenia_map)
wage_gap_map <- armenia_map %>%
left_join(difference_in_mean_salary_by_region, by = c("name" = "region"))
# Step 3: Plot the map
ggplot(wage_gap_map) +
geom_sf(aes(fill = wage_gap), color = "white") +
scale_fill_viridis_c(option = "plasma", direction = -1, name = "Wage Gap (AMD)") +
labs(
title = "Gender Wage Gap by Region (Armenia)",
subtitle = "Difference in mean salary: Male - Female",
caption = "Data: Your Survey"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 16, face = "bold"),
legend.position = "bottom"
)
anti_join(armenia_map, difference_in_mean_salary_by_region, by = c("name" = "region"))
View(difference_in_mean_salary_by_region)
View(armenia_map)
wage_gap_map <- armenia_map %>%
left_join(difference_in_mean_salary_by_region, by = c("name" = "region"))
ggplot(wage_gap_map) +
geom_sf(aes(fill = wage_gap), color = "white") +
scale_fill_gradientn(
colors = c("navy", "skyblue", "yellow", "orange", "red"),
na.value = "gray90",
name = "Wage Gap (AMD)"
) +
labs(
title = "Gender Wage Gap by Region (Armenia)",
subtitle = "Difference in mean salary: Male - Female",
caption = "Data: Your Survey"
) +
theme_minimal()
library(readxl)
library(dplyr)
library(ggplot2)
library(knitr)
library(tidyr)
library(sf)
library(plotly)
p <- ggplot(wage_gap_map) +
geom_sf(aes(fill = wage_gap, text = paste("Region:", name, "<br>Wage Gap:", wage_gap))) +
scale_fill_viridis_c()
ggplotly(p, tooltip = "text")
p <- ggplot(wage_gap_map) +
geom_sf(aes(fill = wage_gap, text = paste("Region:", name, "<br>Wage Gap:", wage_gap))) +
scale_fill_viridis_c() +
theme_minimal()
ggplotly(p, tooltip = "text")
wage_gap_map <- armenia_map %>%
left_join(difference_in_mean_salary_by_region, by = c("name" = "region")) %>%
mutate(display_name = name)  # Use this to preserve your names
ggplot(wage_gap_map) +
geom_sf(aes(fill = wage_gap), color = "white") +
scale_fill_gradientn(
colors = c("navy", "skyblue", "yellow", "orange", "red"),
na.value = "gray90",
name = "Wage Gap (AMD)"
) +
labs(
title = "Gender Wage Gap by Region (Armenia)",
subtitle = "Difference in mean salary: Male - Female",
caption = "Data: Your Survey"
) +
theme_minimal()
region_name_map <- tibble::tibble(
map_name = c("Tavush", "Lori", "Shirak", "Gegharkunik", "Vayots Dzor",
"Syunik", "Ararat", "Aragatsotn", "Armavir", "Kotayk", "Erevan"),
region = c("Tavush", "Lori", "Shirak", "Gegharkunik", "Vayoc Dzor",
"Syuniq", "Ararat", "Aragatsotn", "Armavir", "Kotayq", "Yerevan")  # match your data
)
armenia_map <- armenia_map %>%
left_join(region_name_map, by = c("name" = "map_name"))
wage_gap_map <- armenia_map %>%
left_join(difference_in_mean_salary_by_region, by = "region") %>%
ggplot(wage_gap_map) +
geom_sf(aes(fill = wage_gap), color = "white") +
scale_fill_gradientn(
colors = c("navy", "skyblue", "yellow", "orange", "red"),
na.value = "gray90",
name = "Wage Gap (AMD)"
) +
labs(
title = "Gender Wage Gap by Region (Armenia)",
subtitle = "Difference in mean salary: Male - Female",
caption = "Data: Your Survey"
) +
theme_minimal()
armenia_map <- st_read("armenia.json")
region_name_map <- tibble::tibble(
map_name = c("Tavush", "Lori", "Shirak", "Gegharkunik", "Vayots Dzor",
"Syunik", "Ararat", "Aragatsotn", "Armavir", "Kotayk", "Erevan"),
region = c("Tavush", "Lori", "Shirak", "Gegharkunik", "Vayoc Dzor",
"Syuniq", "Ararat", "Aragatsotn", "Armavir", "Kotayq", "Yerevan")  # match your data
)
armenia_map <- armenia_map %>%
left_join(region_name_map, by = c("name" = "map_name"))
wage_gap_map <- armenia_map %>%
left_join(difference_in_mean_salary_by_region, by = "region") %>%
ggplot(wage_gap_map) +
geom_sf(aes(fill = wage_gap), color = "white") +
scale_fill_gradientn(
colors = c("navy", "skyblue", "yellow", "orange", "red"),
na.value = "gray90",
name = "Wage Gap (AMD)"
) +
labs(
title = "Gender Wage Gap by Region (Armenia)",
subtitle = "Difference in mean salary: Male - Female",
caption = "Data: Your Survey"
) +
theme_minimal()
wage_gap_map <- armenia_map %>%
left_join(difference_in_mean_salary_by_region, by = "region")
ggplot(wage_gap_map) +
geom_sf(aes(fill = wage_gap), color = "white") +
scale_fill_gradientn(
colors = c("navy", "skyblue", "yellow", "orange", "red"),
na.value = "gray90",
name = "Wage Gap (AMD)"
) +
labs(
title = "Gender Wage Gap by Region (Armenia)",
subtitle = "Difference in mean salary: Male - Female",
caption = "Data: Your Survey"
) +
theme_minimal()
p <- ggplot(wage_gap_map) +
geom_sf(aes(fill = wage_gap, text = paste("Region:", name, "<br>Wage Gap:", wage_gap))) +
scale_fill_viridis_c() +
theme_minimal()
ggplotly(p, tooltip = "text")
decoded_data <- cleaned_data %>%
mutate(
B3 = case_when(
B3 == 1 ~ "Male",
B3 == 2 ~ "Female",
TRUE ~ NA_character_
)
) %>%
mutate(
Age_16groups = case_when(
Age_16groups == 1 ~ "0-4",
Age_16groups == 2 ~ "5-9",
Age_16groups == 3 ~ "10-14",
Age_16groups == 4 ~ "15-19",
Age_16groups == 5 ~ "20-24",
Age_16groups == 6 ~ "25-29",
Age_16groups == 7 ~ "30-34",
Age_16groups == 8 ~ "35-39",
Age_16groups == 9 ~ "40-44",
Age_16groups == 10 ~ "45-49",
Age_16groups == 11 ~ "50-54",
Age_16groups == 12 ~ "55-59",
Age_16groups == 13 ~ "60-64",
Age_16groups == 14 ~ "65-69",
Age_16groups == 15 ~ "70-74",
Age_16groups == 16 ~ "75+",
TRUE ~ NA_character_
)
) %>%
mutate(
E15 = case_when(
E15 == 1 ~ "Up to 55 000 AMD",
E15 == 2 ~ "55 000 AMD",
E15 == 3 ~ "55 001 -  110 000 AMD",
E15 == 4 ~ "110 001 - 220 000 AMD",
E15 == 5 ~ "220 001 - 440 000 AMD",
E15 == 6 ~ "440 001 - 600 000 AMD",
E15 == 7 ~ "600 001 - 700 000 AMD",
E15 == 8 ~ "Refused to answer",
E15 == 9 ~ "Do not know / difficult to answer",
TRUE ~ NA_character_
)
) %>%
mutate(
A3 = case_when(
A3 == 1 ~ "Yerevan",
A3 == 2 ~ "Aragatsotn",
A3 == 3 ~ "Ararat",
A3 == 4 ~ "Armavir",
A3 == 5 ~ "Gegharkunik",
A3 == 6 ~ "Lori",
A3 == 7 ~ "Kotayq",
A3 == 8 ~ "Shirak",
A3 == 9 ~ "Syuniq",
A3 == 10 ~ "Vayoc Dzor",
A3 == 11 ~ "Tavush",
TRUE ~ NA_character_
)
) %>%
mutate(
A5 = case_when(
A5 == 1 ~ "Urban",
A5 == 2 ~ "Rural",
TRUE ~ NA_character_
)
)
urban_rural_mean_salary <- decoded_data %>%
select(settlement = A5, gender = B3, salary = E14_1) %>%
filter(!is.na(region), !is.na(gender), !is.na(salary)) %>%
group_by(settlement, gender) %>%
summarise(mean_salary = mean(salary, na.rm = TRUE))
urban_rural_mean_salary <- decoded_data %>%
select(settlement = A5, gender = B3, salary = E14_1) %>%
filter(!is.na(settlement), !is.na(gender), !is.na(salary)) %>%
group_by(settlement, gender) %>%
summarise(mean_salary = mean(salary, na.rm = TRUE))
decoded_data %>%
filter(!is.na(E14_1), !is.na(A5)) %>%   # Remove NAs
ggplot(aes(x = settlement, y = E14_1, fill = settlement)) +
geom_boxplot(outlier.color = "red", outlier.alpha = 0.3) +
labs(
title = "Income Distribution: Urban vs Rural",
x = "Settlement Type",
y = "Salary (AMD)"
) +
theme_minimal() +
scale_fill_manual(values = c("Urban" = "#66c2a5", "Rural" = "#fc8d62"))
urban_rural_mean_salary <- decoded_data %>%
select(settlement = A5, gender = B3, salary = E14_1) %>%
filter(!is.na(settlement), !is.na(gender), !is.na(salary)) %>%
group_by(settlement) %>%
summarise(mean_salary = mean(salary, na.rm = TRUE))
urban_rural_mean_salary <- decoded_data %>%
select(settlement = A5, gender = B3, salary = E14_1) %>%
filter(!is.na(settlement), !is.na(gender), !is.na(salary)) %>%
group_by(settlement, gender) %>%
summarise(mean_salary = mean(salary, na.rm = TRUE))
urban_rural_mean_salary
urban_rural_mean_salary <- decoded_data %>%
select(settlement = A5, gender = B3, salary = E14_1) %>%
filter(!is.na(settlement), !is.na(gender), !is.na(salary)) %>%
group_by(settlement, gender) %>%
summarise(mean_salary = mean(salary), min_salary = min(salary), max_salary = max(salary))
urban_rural_mean_salary
View(urban_rural_mean_salary)
ggplot(urban_rural_salary, aes(x = settlement, y = E14_1, fill = settlement)) +
geom_boxplot(outlier.color = "red", outlier.alpha = 0.3) +
labs(
title = "Income Distribution: Urban vs Rural",
x = "Settlement Type",
y = "Salary (AMD)"
) +
theme_minimal() +
scale_fill_manual(values = c("Urban" = "#66c2a5", "Rural" = "#fc8d62"))
urban_rural_salary <- decoded_data %>%
select(settlement = A5, gender = B3, salary = E14_1) %>%
filter(!is.na(settlement), !is.na(gender), !is.na(salary)) %>%
group_by(settlement, gender) %>%
summarise(mean_salary = mean(salary), min_salary = min(salary), max_salary = max(salary))
urban_rural_salary
ggplot(urban_rural_salary, aes(x = settlement, y = E14_1, fill = settlement)) +
geom_boxplot(outlier.color = "red", outlier.alpha = 0.3) +
labs(
title = "Income Distribution: Urban vs Rural",
x = "Settlement Type",
y = "Salary (AMD)"
) +
theme_minimal() +
scale_fill_manual(values = c("Urban" = "#66c2a5", "Rural" = "#fc8d62"))
ggplot(urban_rural_salary, aes(x = settlement, y = salary, fill = settlement)) +
geom_boxplot(outlier.color = "red", outlier.alpha = 0.3) +
labs(
title = "Income Distribution: Urban vs Rural",
x = "Settlement Type",
y = "Salary (AMD)"
) +
theme_minimal() +
scale_fill_manual(values = c("Urban" = "#66c2a5", "Rural" = "#fc8d62"))
ggplot(decoded_data, aes(x = A5, y = E14_1, fill = A5)) +
geom_boxplot(outlier.color = "red", outlier.alpha = 0.3) +
labs(
title = "Income Distribution: Urban vs Rural",
x = "Settlement Type",
y = "Salary (AMD)"
) +
theme_minimal() +
scale_fill_manual(values = c("Urban" = "#66c2a5", "Rural" = "#fc8d62"))
ggplot(decoded_data, aes(x = A5, y = E14_1, fill = A5)) +
geom_boxplot(outlier.color = "red", outlier.alpha = 0.3) +
coord_cartesian(ylim = c(0, 500000)) +
labs(
title = "Income Distribution: Urban vs Rural",
x = "Settlement Type",
y = "Salary (AMD)"
) +
theme_minimal() +
scale_fill_manual(values = c("Urban" = "#66c2a5", "Rural" = "#fc8d62"))
