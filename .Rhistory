) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
educational_levels <- c("Illiterate", "No primary", "Primary", "Basic", "Secondary / high",
"Vocational", "Secondary specialized", "Bachelor's degree",
"Master's degree", "Certified specialist",
"Post-graduate (Ph.D, doctorate)")
people_by_education <- data %>%
group_by(B7) %>%
summarise(n = n()) %>%
mutate(B7 = factor(B7, levels = 1:11, labels = educational_levels)) %>%
rename(
educational_level = B7,
population = n
)
people_by_education
ggplot(people_by_education, aes(x = educational_level, y = population)) +
geom_col(fill = "plum3") +
theme_minimal() +
labs(
title = "Population by Educational Level",
x = "Educational Level",
y = "Population"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
nace_sectors <- c(
"Agriculture, Forestry and Fishing",
"Mining and Quarrying",
"Manufacturing",
"Electricity, Gas, Steam and Air Conditioning Supply",
"Water Supply; Sewerage, Waste Management and Remediation Activities",
"Construction",
"Wholesale and Retail Trade; Repair of Motor Vehicles and Motorcycles",
"Transportation and Storage",
"Accommodation and Food Service Activities",
"Publishing, Broadcasting, and Content Production and Distribution Activities",
"Telecommunication, Computer Programming, Consulting, Computing Infrastructure, and other Information Service Activities",
"Financial and Insurance Activities",
"Real Estate Activities",
"Professional, Scientific and Technical Activities",
"Administrative and Support Service Activities",
"Public Administration and Defence; Compulsory Social Security",
"Education",
"Human Health and Social Work Activities",
"Arts, Sports and Recreation",
"Other Service Activities",
"Activities of Households as Employers; Undifferentiated Goods and Services Producing Activities of Households for Own Use"
)
employees_by_industry <- data %>%
group_by(E4_21groups_NACE_rev_2.2) %>%
summarise(n = n()) %>%
mutate(E4_21groups_NACE_rev_2.2 = factor(E4_21groups_NACE_rev_2.2, levels = 1:21, labels = nace_sectors)) %>%
rename(
industry = E4_21groups_NACE_rev_2.2,
employee_number = n
)
employees_by_industry
exact_salary_data_points <- data %>%
select(E14_1) %>%
na.omit() %>%
summarise(n = n())
exact_salary_data_points
exact_salary_desc <- data %>%
select(E14_1) %>%
na.omit() %>%
summarise(mean = mean(E14_1), max = max(E14_1), min = min(E14_1), median = median(E14_1))
exact_salary_desc
mean_salary_by_gender <- data %>%
select(E14_1, B3) %>%
mutate(B3 = factor(B3, levels = 1:2, labels = c("Male", "Female"))) %>%
na.omit() %>%
group_by(B3) %>%
summarise(mean = mean(E14_1), median = median(E14_1), min = min(E14_1), max = max(E14_1))
mean_salary_by_gender
salary_data <- data %>%
select(salary = E14_1, gender_code = B3) %>%
mutate(
gender = factor(gender_code, levels = c(1, 2), labels = c("Male", "Female"))
) %>%
filter(!is.na(salary), !is.na(gender))
ggplot(salary_data, aes(x = gender, y = salary, fill = gender)) +
geom_boxplot(outlier.shape = NA) +
coord_cartesian(ylim = c(0, 500000)) +
theme_minimal() +
scale_fill_manual(values = c("Male" = "#56B4E9", "Female" = "#E78AC3")) +
labs(
title = "Salary Distribution by Gender",
x = "Gender",
y = "Salary"
) +
theme(legend.position = "none")
income_ranges <- c(
"Up to 55 000 AMD",
"55 000 AMD",
"55 001 - 110 000 AMD",
"110 001 - 220 000 AMD",
"220 001 - 440 000 AMD",
"440 001 - 600 000 AMD",
"600 001 - 700 000 AMD",
"Refused to answer",
"Do not know / difficult to answer"
)
categorical_salary_data_points <- data %>%
select(E15) %>%
na.omit() %>%
summarise(n = n())
categorical_salary_data_points
categorical_salary_frequency <- data %>%
group_by(E15) %>%
summarise(n = n()) %>%
na.omit() %>%
mutate(E15 = factor(E15, levels = 1:9, labels = income_ranges)) %>%
rename(
income_range = E15,
frequency = n
)
categorical_salary_frequency
ggplot(categorical_salary_frequency, aes(x = income_range, y = frequency)) +
geom_col(fill = "plum3") +
theme_minimal() +
labs(
title = "Salary Histogram",
x = "Income Ranges",
y = "Frequency"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
categorical_salary_data_points <- data %>%
select(E15) %>%
na.omit() %>%
summarise(number_of_data_points = n())
categorical_salary_data_points
categorical_salary_data_points <- data %>%
select(E15) %>%
na.omit() %>%
summarise(number_of_data_points = n())
categorical_salary_data_points
categorical_salary_frequency <- data %>%
group_by(E15) %>%
summarise(n = n()) %>%
na.omit() %>%
mutate(E15 = factor(E15, levels = 1:9, labels = income_ranges)) %>%
rename(
income_range = E15,
frequency = n
)
categorical_salary_frequency
ggplot(categorical_salary_frequency, aes(x = income_range, y = frequency)) +
geom_col(fill = "plum3") +
theme_minimal() +
labs(
title = "Salary Histogram",
x = "Income Ranges",
y = "Frequency"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
empty_rows <- which(rowSums(is.na(df)) == ncol(df))
library(readxl)
library(dplyr)
library(ggplot2)
data <- read_excel("data.xlsx", sheet = "LFS_Year_2023")
regions <- c(
"Yerevan",
"Aragatsotn",
"Ararat",
"Armavir",
"Gegharkunik",
"Lori",
"Kotayq",
"Shirak",
"Syuniq",
"Vayoc Dzor",
"Tavush"
)
people_by_regions <- data %>%
group_by(A3) %>%
summarise(
n = n()
) %>%
mutate(A3 = factor(A3, levels = 1:11, labels = regions)) %>%
rename(
region = A3,
population = n
)
people_by_regions
ggplot(people_by_regions, aes(x = region, y = population)) +
geom_col(fill = "plum3") +
theme_minimal() +
labs(
title = "Population by Regions",
x = "Regions",
y = "Population"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
urban_rural <- data %>%
group_by(A5) %>%
summarise(n = n()) %>%
mutate(A5 = factor(A5, levels = c(1, 2), labels = c("Urban", "Rural")))
urban_rural
gender_ratio <- data %>%
group_by(B3) %>%
summarise(n = n()) %>%
mutate(B3 = factor(B3, levels = c(1, 2), labels = c("Male", "Female")))
gender_ratio
age_groups <- c(
"0 - 4",
"5 - 9",
"10 - 14",
"15 - 19",
"20 - 24",
"25 - 29",
"30 - 34",
"35 - 39",
"40 - 44",
"45 - 49",
"50 - 54",
"55 - 59",
"60 - 64",
"65 - 69",
"70 - 74",
"75+"
)
people_by_age <- data %>%
group_by(Age_16groups) %>%
summarise(n = n()) %>%
mutate(Age_16groups = factor(Age_16groups, levels = 1:16, labels = age_groups)) %>%
rename(
age_group = Age_16groups,
population = n
)
people_by_age
ggplot(people_by_age, aes(x = age_groups, y = population)) +
geom_col(fill = "plum3") +
theme_minimal() +
labs(
title = "Population by Age Group",
x = "Age Group",
y = "Population"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
educational_levels <- c("Illiterate", "No primary", "Primary", "Basic", "Secondary / high",
"Vocational", "Secondary specialized", "Bachelor's degree",
"Master's degree", "Certified specialist",
"Post-graduate (Ph.D, doctorate)")
people_by_education <- data %>%
group_by(B7) %>%
summarise(n = n()) %>%
mutate(B7 = factor(B7, levels = 1:11, labels = educational_levels)) %>%
rename(
educational_level = B7,
population = n
)
people_by_education
ggplot(people_by_education, aes(x = educational_level, y = population)) +
geom_col(fill = "plum3") +
theme_minimal() +
labs(
title = "Population by Educational Level",
x = "Educational Level",
y = "Population"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
nace_sectors <- c(
"Agriculture, Forestry and Fishing",
"Mining and Quarrying",
"Manufacturing",
"Electricity, Gas, Steam and Air Conditioning Supply",
"Water Supply; Sewerage, Waste Management and Remediation Activities",
"Construction",
"Wholesale and Retail Trade; Repair of Motor Vehicles and Motorcycles",
"Transportation and Storage",
"Accommodation and Food Service Activities",
"Publishing, Broadcasting, and Content Production and Distribution Activities",
"Telecommunication, Computer Programming, Consulting, Computing Infrastructure, and other Information Service Activities",
"Financial and Insurance Activities",
"Real Estate Activities",
"Professional, Scientific and Technical Activities",
"Administrative and Support Service Activities",
"Public Administration and Defence; Compulsory Social Security",
"Education",
"Human Health and Social Work Activities",
"Arts, Sports and Recreation",
"Other Service Activities",
"Activities of Households as Employers; Undifferentiated Goods and Services Producing Activities of Households for Own Use"
)
employees_by_industry <- data %>%
group_by(E4_21groups_NACE_rev_2.2) %>%
summarise(n = n()) %>%
mutate(E4_21groups_NACE_rev_2.2 = factor(E4_21groups_NACE_rev_2.2, levels = 1:21, labels = nace_sectors)) %>%
rename(
industry = E4_21groups_NACE_rev_2.2,
employee_number = n
)
employees_by_industry
exact_salary_data_points <- data %>%
select(E14_1) %>%
na.omit() %>%
summarise(n = n())
exact_salary_data_points
exact_salary_desc <- data %>%
select(E14_1) %>%
na.omit() %>%
summarise(mean = mean(E14_1), max = max(E14_1), min = min(E14_1), median = median(E14_1))
exact_salary_desc
mean_salary_by_gender <- data %>%
select(E14_1, B3) %>%
mutate(B3 = factor(B3, levels = 1:2, labels = c("Male", "Female"))) %>%
na.omit() %>%
group_by(B3) %>%
summarise(mean = mean(E14_1), median = median(E14_1), min = min(E14_1), max = max(E14_1))
mean_salary_by_gender
salary_data <- data %>%
select(salary = E14_1, gender_code = B3) %>%
mutate(
gender = factor(gender_code, levels = c(1, 2), labels = c("Male", "Female"))
) %>%
filter(!is.na(salary), !is.na(gender))
ggplot(salary_data, aes(x = gender, y = salary, fill = gender)) +
geom_boxplot(outlier.shape = NA) +
coord_cartesian(ylim = c(0, 500000)) +
theme_minimal() +
scale_fill_manual(values = c("Male" = "#56B4E9", "Female" = "#E78AC3")) +
labs(
title = "Salary Distribution by Gender",
x = "Gender",
y = "Salary"
) +
theme(legend.position = "none")
income_ranges <- c(
"Up to 55 000 AMD",
"55 000 AMD",
"55 001 - 110 000 AMD",
"110 001 - 220 000 AMD",
"220 001 - 440 000 AMD",
"440 001 - 600 000 AMD",
"600 001 - 700 000 AMD",
"Refused to answer",
"Do not know / difficult to answer"
)
empty_rows <- which(rowSums(is.na(df)) == ncol(df))
empty_rows <- which(rowSums(is.na(df)) == ncol(df))
ggplot(categorical_salary_frequency, aes(x = income_range, y = frequency)) +
geom_col(fill = "plum3") +
theme_minimal() +
labs(
title = "Salary Histogram",
x = "Income Ranges",
y = "Frequency"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
empty_rows <- which(rowSums(is.na(df)) == ncol(df))
cols_to_work <- data[, c('A3', 'A5', 'A6_Month', 'A6_Year', 'B3', 'Age_16groups', 'B7', 'B8',
'B8_Year', 'B9', 'B10', 'B11', 'C1', 'C9', 'C4', 'C3', 'D1', 'D2', 'D3', 'E2_9group',
'E4_21groups_NACE_rev_2.2', 'E5', 'E6', 'E7', 'E9', 'E10', 'E13', 'E14_1', 'E14_2', 'E15', 'E16',
'E17', 'E19', 'E23', 'E24', 'F1', 'F2_9group', 'F3_21groups_NACE_rev_2.2', 'F4', 'F5',
'F6', 'F8_1', 'F8_2', 'G2_1', 'G2_2', 'G2_3Total', 'G3', 'J1_4group', 'J3_1', 'J3_2', 'J3_LastJob')]
missing_per_row <- rowSums(is.na(cols_to_work))
total_cols <- length(cols_to_work)
exceeds <- which(missing_per_row > 0.5 * total_cols)
good_rows <-length(exceeds)
print(good_rows)
sum(apply(data, 1, function(row) all(is.na(row))))
cols_to_check <- c('A3', 'A5', 'A6_Month', 'A6_Year', 'B3', 'Age_16groups', 'B7', 'B8',
'B8_Year', 'B9', 'B10', 'B11', 'C1', 'C9', 'C4', 'C3', 'D1', 'D2', 'D3', 'E2_9group',
'E4_21groups_NACE_rev_2.2', 'E5', 'E6', 'E7', 'E9', 'E10', 'E13', 'E14_1', 'E14_2', 'E15', 'E16',
'E17', 'E19', 'E23', 'E24', 'F1', 'F2_9group', 'F3_21groups_NACE_rev_2.2', 'F4', 'F5',
'F6', 'F8_1', 'F8_2', 'G2_1', 'G2_2', 'G2_3Total', 'G3', 'J1_4group', 'J3_1', 'J3_2', 'J3_LastJob')
sum(rowSums(is.na(data[cols_to_check])) > 0)
sort(colSums(is.na(data)), decreasing = TRUE)
sort(colSums(is.na(data[cols_to_check])), decreasing = TRUE)
most_important <- c("A3", "A5", "B3", "B7", "E4_21groups_NACE_rev_2.2", "E14_1")
sort(colSums(is.na(data[most_important])), decreasing = TRUE)
data %>%
filter(!is.na(E4_21groups_NACE_rev_2.2) | !is.na(E14_1))
data$E14_2
sum(is.na(data$E14_2))
sum(!is.na(data$E14_2))
data %>%
filter(!is.na(E14_2))
data %>%
filter(!is.na(E14_2)) %>%
select(E14_2)
data %>%
filter(!is.na(E14_2)) %>%
select(E14_2) %>%
summarise(mode = mode())
data %>%
filter(!is.na(E14_2)) %>%
select(E14_2) %>%
summarise(mode = mode(E14_2))
data %>%
filter(!is.na(E14_2)) %>%
select(E14_2) %>%
summarise(mode = mode())
data %>%
filter(!is.na(E14_2)) %>%
select(E14_2) %>%
summarise(mode = get_mode(E14_2))
uniqx[which.max(tabulate(match(x, uniqx)))]
get_mode <- function(x) {
uniqx <- unique(x)
uniqx[which.max(tabulate(match(x, uniqx)))]
}
data %>%
filter(!is.na(E14_2)) %>%
select(E14_2) %>%
summarise(mode = get_mode(E14_2))
data %>%
filter(!is.na(E14_2)) %>%
count(E14_2, sort = TRUE)
library(readxl)
library(dplyr)
library(ggplot2)
library(readxl)
library(dplyr)
library(ggplot2)
data <- read_excel("data.xlsx", sheet = "LFS_Year_2023")
most_important <- c("A3", "A5", "B3", "B7", "E4_21groups_NACE_rev_2.2", "E14_1")
labels <- c("Marz", "Urban/Rural", "Sex", "Educational Level", "Industry", "Income (Numerical)", "Income (Categorical)")
sort(colSums(is.na(data[most_important])), decreasing = TRUE)
missing_value_count <- data %>%
select(most_important)
missing_value_count <- data %>%
select(all_of(most_important)) %>%
summarise(across(everything(), ~sum(is.na(.)))) %>%
pivot_longer(cols = everything(), names_to = "variable", values_to = "missing") %>%
mutate(label = labels)
missing_value_count <- data %>%
select(all_of(most_important)) %>%
summarise(across(everything(), ~sum(is.na(.)))) %>%
mutate(label = labels)
missing_value_count <- data %>%
select(all_of(most_important)) %>%
summarise(across(everything(), ~sum(is.na(.))))
missing_value_count <- data %>%
select(all_of(most_important)) %>%
summarise(across(everything(), ~sum(is.na(.))))
missing_value_count
?pivot_longer
cleaned_data <- data %>%
filter(!is.na(E4_21groups_NACE_rev_2.2) | !is.na(E14_1))
cleaned_data <- data %>%
filter(!is.na(E4_21groups_NACE_rev_2.2) | !is.na(E14_1))
cleaned_data
missing_table <- data %>%
select(all_of(most_important)) %>%
summarise(across(everything(), ~sum(is.na(.)))) %>%
pivot_longer(cols = everything(), names_to = "variable", values_to = "missing") %>%
mutate(label = labels)
missing_table <- data %>%
select(all_of(most_important)) %>%
summarise(across(everything(), ~sum(is.na(.)))
missing_value_count
missing_table <- data %>%
select(all_of(most_important)) %>%
summarise(across(everything(), ~sum(is.na(.))))
missing_value_count
most_important <- c("A3", "A5", "B3", "B7", "E4_21groups_NACE_rev_2.2", "E14_1", "E15")
labels <- c("Marz", "Urban/Rural", "Sex", "Educational Level", "Industry", "Income (Numerical)", "Income (Categorical)")
sort(colSums(is.na(data[most_important])), decreasing = TRUE)
missing_table <- data %>%
select(all_of(most_important)) %>%
summarise(across(everything(), ~sum(is.na(.))))
missing_value_count
most_important <- c("A3", "A5", "B3", "B7", "E4_21groups_NACE_rev_2.2", "E14_1", "E15")
labels <- c("Marz", "Urban/Rural", "Sex", "Educational Level", "Industry", "Income (Numerical)", "Income (Categorical)")
sort(colSums(is.na(data[most_important])), decreasing = TRUE)
missing_table <- data %>%
select(all_of(most_important)) %>%
summarise(across(everything(), ~sum(is.na(.))))
missing_value_count
missing_table <- data %>%
select(A3, A5, B3, B7, E4_21groups_NACE_rev_2.2, E14_1, E15) %>%
summarise(across(everything(), ~sum(is.na(.)))) %>%
mutate(label = labels)
missing_table <- data %>%
select(A3, A5, B3, B7, E4_21groups_NACE_rev_2.2, E14_1, E15) %>%
summarise(across(everything(), ~sum(is.na(.))))
missing_value_count
missing_table <- data %>%
select(A3, A5, B3, B7, E4_21groups_NACE_rev_2.2, E14_1, E15) %>%
summarise(sum(is.na(.)))
missing_value_count
missing_table <- data %>%
select(E15) %>%
summarise(sum(is.na(.)))
missing_value_count
missing_table <- data %>%
select(E15) %>%
summarise(sum(is.na(.)))
missing_value_count
View(missing_value_count)
missing_table <- data %>%
select(A3, A5, B3, B7, E4_21groups_NACE_rev_2.2, E14_1, E15) %>%
summarise(across(everything(), ~sum(is.na(.)))) %>%
mutate(label = labels)
missing_table <- data %>%
select(A3, A5, B3, B7, E4_21groups_NACE_rev_2.2, E14_1, E15) %>%
summarise(across(everything(), ~sum(is.na(.))))
missing_table
missing_value_count <- data %>%
select(A3, A5, B3, B7, E4_21groups_NACE_rev_2.2, E14_1, E15) %>%
summarise(across(everything(), ~sum(is.na(.))))
missing_value_count
sort(colSums(is.na(data[most_important])), decreasing = TRUE)
most_important <- c("A3", "A5", "B3", "B7", "E4_21groups_NACE_rev_2.2", "E14_1", "E15")
labels <- c("Marz", "Urban/Rural", "Sex", "Educational Level", "Industry", "Income (Numerical)", "Income (Categorical)")
missing_value_count <- data %>%
select(A3, A5, B3, B7, E4_21groups_NACE_rev_2.2, E14_1, E15) %>%
summarise(across(everything(), ~sum(is.na(.))))
missing_value_count
cleaned_data <- data %>%
filter(!is.na(E14_1) | !is.na(E15))
cleaned_data
